<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Eprhsa</title>
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    
    <!-- Don't use this in production: -->
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
  </head>
  <body>

    <div id="root"></div>
    
    <script type="text/babel">


   
   const EpisodeList = (props) => {
   
     let items = props.episodes.map((episode) => {
       return <li onClick={props.show} id={episode._id} key={episode._id}>{episode.title}</li>
     })
       console.log(items);
     return <ul>{items}</ul>
   }
   
   const Detail = (props) => {
     console.log(props.episode)
     return <div><p>name {props.episode.title}</p>
     <p>season {props.episode.season}</p>
     <p>epnum {props.episode.epnum}</p>
     </div>
     
   }

   
   
    
   
   
   
   
   
    
   class App extends React.Component {
     constructor(props) {
       super(props);
         
       this.state = {
         episodes:{{{episodes}}},
             filter: "",
         current_episode: {},
        
         
       };
       
        
       this.showDetail = this.showDetail.bind(this);
       this.onDelete = this.onDelete.bind(this);
       this.onAdd = this.onAdd.bind(this);
this.onSearch = this.onSearch.bind(this);
     }
  
   
     showDetail(event) {
      
       var found = this.state.episodes.find((item) =>{
  return item._id === event.target.id;
});

      this.setState({current_episode: found})
       
     }

          
            
//      onDelete(){
//        let id = this.state.current_episode.epnum;
//        
//        fetch("/api/v1/delete/" + id).then((response) => {
//          return response.json();
//        }).then((results) => {
//          // Filter all items except the one to be removed
//          const remainder = this.state.items.filter((episodes) => {
//            return item.epnum !== id;
//          });
//          // Update state with new array
//          this.setState({episodes: remainder, episode: {}});
//        });
//          
//      }
        
    onDelete(){
        let id = this.state.current_episode.epnum;
        let butt = this.state.episodes;
        
            fetch('api/v1/delete/' + id, {
               method: "GET",
               headers: { 'Content-Type': 'application/json' },
               body: JSON.stringify()
                
                }).then(res => res.json())
             .then(json => this.setState({episodes: butt }))
            }
           
               

                



onSubmit(event) {
    event.preventDefault();
    console.log(this.epnumInput.value);

}

onClick(event){
    event.preventDefault();
}

onAdd(event){
    fetch('add',  {
        method: 'POST',
  headers: {
    'Accept': 'application/json',
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    epnum: this.epnumInput.value,
    season: this.seasonInput.value,
      title: this.titleInput.value,
      
  })
})
}

   
        
     render() {
       
       return <div>
        <h2>Page Title</h2>
        <EpisodeList show={this.showDetail} episodes={this.state.episodes} />
        <Detail episode={this.state.current_episode} />
        
           <button onClick={this.onDelete.bind(this)}>
        Delete?
      </button>
           <form onSubmit={this.onAdd.bind(this)}>
          <input placeholder="epnum" ref={epnumInput => this.epnumInput = epnumInput}/>
            <input placeholder="title" ref={titleInput => this.titleInput = titleInput}/>
            <input placeholder="season" ref={seasonInput => this.seasonInput = seasonInput}/>
           <button>Add</button>
               </form>
           <hr/>
        </div>
       
     }
   }
   
   
   
//   class LoggingButton extends React.Component {
//  handleClick() {
//    console.log('this is:', this);
//      
//  }
//
//  render() {
//    // This syntax ensures `this` is bound within handleClick
//    return (
//      <button onClick={(e) => this.handleClick(e)}>
//        Delete
//      </button>
//    );
//  }
//}
   
   
   
//   class NameForm extends React.Component {
//  constructor(props) {
//    super(props);
//    this.state = {value: ''};
//
//    this.handleChange = this.handleChange.bind(this);
//    this.handleSubmit = this.handleSubmit.bind(this);
//  }
//
//  handleChange(event) {
//    this.setState({value: event.target.value});
//  }
//
//  handleSubmit(event) {
//    
//    event.preventDefault();
//  }
//
//  render() {
//    return (
//      <form onSubmit={this.handleSubmit}>
//        <label>
//          Name:
//          <input type="text" value={this.state.value} onChange={this.handleChange} />
//        </label>
//        <input type="submit" value="Submit" />
//      </form>
//    );
//  }
//}
    
    ReactDOM.render( <div>
        <App />
        
        </div> ,  document.getElementById('root') );
    
    
    
    
    
    
    
    </script>
    <!--
      Note: this page is a great way to try React but it's not suitable for production.
      It slowly compiles JSX with Babel in the browser and uses a large development build of React.

      Read this section for a production-ready setup with JSX:
      http://reactjs.org/docs/add-react-to-a-website.html#add-jsx-to-a-project

      In a larger project, you can use an integrated toolchain that includes JSX instead:
      http://reactjs.org/docs/create-a-new-react-app.html

      You can also use React without JSX, in which case you can remove Babel:
      https://reactjs.org/docs/react-without-jsx.html
    -->
  </body>
</html>